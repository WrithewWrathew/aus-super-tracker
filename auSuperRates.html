<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>AusSuper International Shares</title>
<style>
  body { font-family: Arial, sans-serif; padding: 40px; max-width: 600px; margin: auto; background: #f5f5f5; }
  #output { font-size: 2.5em; margin: 30px 0; padding: 20px; background: white; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
  button { padding: 12px 24px; font-size: 1.1em; background: #0078d4; color: white; border: none; border-radius: 6px; cursor: pointer; margin: 10px; }
  button:hover { background: #106ebe; }
  button:disabled { background: #ccc; cursor: not-allowed; }
  input[type="file"] { margin: 20px 0; }
  .instructions { background: #e7f3ff; padding: 15px; border-radius: 6px; margin: 20px 0; }
</style>
</head>
<body>

<h1>ðŸ¤‘ AusSuper International Shares Tracker</h1>

<div class="instructions">
  <strong>Step 1:</strong> Visit <a href="https://www.australiansuper.com//api/graphs/dailyrates/download/?start=01/02/2026&end=08/02/2026&cumulative=False&superType=super&truncateDecimalPlaces=True&outputFilename=temp.csv" target="_blank">this URL</a> and download <code>temp.csv</code><br>
  <strong>Step 2:</strong> Click "Choose File" below and select the CSV
</div>

<input type="file" id="fileInput" accept=".csv">
<div id="output">Choose the temp.csv file to see the latest International Shares move</div>
<button id="rescanBtn" disabled>ðŸ”„ Re-Scan Same File</button>

<script>
let lastFile = null;

function processCsv(text) {
  const output = document.getElementById("output");
  const rows = text.trim().split(/\r?\n/);
  
  if (rows.length < 2) {
    output.textContent = "No data in CSV.";
    return;
  }

  const headers = rows[0].split(",");
  const intlIndex = headers.indexOf("International Shares");
  
  if (intlIndex === -1) {
    output.textContent = "'International Shares' column not found.";
    return;
  }

  // Find last non-empty row
  let lastRow = null;
  for (let i = rows.length - 1; i > 0; i--) {
    const cols = rows[i].split(",");
    const hasData = cols.some(col => col.trim() && col.trim() !== "0");
    if (hasData) {
      lastRow = cols;
      break;
    }
  }

  if (!lastRow) {
    output.textContent = "Currently no change.";
    return;
  }

  const intlValue = parseFloat(lastRow[intlIndex].trim());
  
  if (isNaN(intlValue) || intlValue === 0) {
    output.textContent = "Currently no change.";
    return;
  }

  const pct = intlValue.toFixed(2);
  output.textContent = `${pct === '0.00' ? 'Currently no change.' : pct + '%'} `;
  output.style.color = intlValue >= 0 ? '#00aa00' : '#cc0000';
}

document.getElementById("fileInput").addEventListener("change", (e) => {
  const file = e.target.files[0];
  if (file) {
    lastFile = file;
    document.getElementById("rescanBtn").disabled = false;
    const reader = new FileReader();
    reader.onload = (e) => processCsv(e.target.result);
    reader.readAsText(file);
  }
});

document.getElementById("rescanBtn").addEventListener("click", () => {
  if (lastFile) {
    const reader = new FileReader();
    reader.onload = (e) => processCsv(e.target.result);
    reader.readAsText(lastFile);
  }
});
</script>

</body>
</html>
